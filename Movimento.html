<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Porco's Adventure</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background-color: #000;
    }
    canvas {
      display: block;
    }
  </style>
</head>
<body>
  <canvas id="gameCanvas"></canvas>

  <script>
    let showBox = false;
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');

    const config = {
      pigSpeed: 4,
      pigWidth: 150,
      pigHeight: 150
    };

    const pig = {
      x: 80,
      y: 0,
      width: config.pigWidth,
      height: config.pigHeight,
      speed: config.pigSpeed,
      velocityY: 0,
      isJumping: false,
      direction: 'right'
    };

    const gravity = 0.5;
    const jumpForce = -12;
    let groundY = 0; // Será atualizado no resize
    let groundHeight = 0;

    const keys = {
      ArrowUp: false,
      ArrowDown: false,
      ArrowLeft: false,
      ArrowRight: false
    };

    const assets = {
      background: new Image(),
      pig: new Image()
    };

    assets.background.src = './Imagens/Mapa1.png';
    assets.pig.src = './Imagens/Personagem.png';

    function resizeCanvas() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
      groundHeight = canvas.height / 1.33;
      groundY = groundHeight - pig.height;
    }

    window.addEventListener('resize', resizeCanvas);

    document.addEventListener('keydown', e => {
      if (keys.hasOwnProperty(e.key)) keys[e.key] = true;
    });

    document.addEventListener('keyup', e => {
      if (keys.hasOwnProperty(e.key)) keys[e.key] = false;
    });

    function update() {
  let moveX = 0;

  if (keys.ArrowLeft) {
    moveX -= pig.speed;
    pig.direction = 'left';
  }
  if (keys.ArrowRight) {
    moveX += pig.speed;
    pig.direction = 'right';
  }

  if (keys.ArrowUp && !pig.isJumping) {
    pig.velocityY = jumpForce;
    pig.isJumping = true;
  }

  pig.velocityY += gravity;
  pig.y += pig.velocityY;

  if (pig.y >= groundY) {
    pig.y = groundY;
    pig.velocityY = 0;
    pig.isJumping = false;
  }

  pig.x = Math.max(0, Math.min(canvas.width - pig.width, pig.x + moveX));
}

document.addEventListener('keydown', e => {
  if (keys.hasOwnProperty(e.key)) keys[e.key] = true;

  // Se apertar E e o porco estiver entre 817 e 1093 no eixo X
  if (e.key === 'e' || e.key === 'E') {
    if (pig.x >= 817 && pig.x <= 1093) {
      showBox = !showBox; // alterna a caixa
    }
  }
});



    function draw() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Cenário de fundo
      ctx.drawImage(assets.background, 0, 0, canvas.width, canvas.height);

      // Personagem com espelhamento para virar
      ctx.save();
      if (pig.direction === 'left') {
        ctx.translate(pig.x + pig.width, pig.y);
        ctx.scale(-1, 1);
        ctx.drawImage(assets.pig, 0, 0, pig.width, pig.height);
      } else {
        ctx.drawImage(assets.pig, pig.x, pig.y, pig.width, pig.height);
      }
      ctx.restore();

      const debug = true;
      if (debug) {
      ctx.fillStyle = 'white';
      ctx.font = '16px monospace';
      ctx.fillText(`x: ${Math.round(pig.x)}, y: ${Math.round(pig.y)}`, 20, 30);
    }

    if (showBox) {
  const boxWidth = 700;
  const boxHeight = 200;
  const centerX = canvas.width / 2 - boxWidth / 2;
  const centerY = canvas.height - boxHeight - 50;

  // Caixa de fundo
  ctx.fillStyle = 'rgba(0, 0, 0, 0.8)';
  ctx.fillRect(centerX, centerY, boxWidth, boxHeight);

  // Borda da caixa
  ctx.strokeStyle = 'white';
  ctx.lineWidth = 4;
  ctx.strokeRect(centerX, centerY, boxWidth, boxHeight);

  // Texto de interação
  ctx.fillStyle = 'white';
  ctx.font = '20px sans-serif';
  ctx.fillText("Pressione 'E' para continuar...", centerX + 20, centerY + 50);

  // Texto de exemplo de interação
  ctx.font = '18px sans-serif';
  ctx.fillText("Olá, viajante! Bem-vindo ao mundo dos porcos aventureiros.", centerX + 20, centerY + 90);
}
    }

    function gameLoop() {
      update();
      draw();
      requestAnimationFrame(gameLoop);
    }

    let loadedAssets = 0;
    function checkLoaded() {
      loadedAssets++;
      if (loadedAssets === 2) {
        resizeCanvas();
        gameLoop();
      }
    }

    assets.background.onload = checkLoaded;
    assets.pig.onload = checkLoaded;
  </script>
</body>
</html>